<!DOCTYPE html>
<html lang="en" class="yui-overrride">
<head>
    <meta charset="utf-8">
    <title>/home/lhawsa/Documents/projects/openveo/openveo-portal/app/client/admin/index.controller.js - OpenVeo Portal administration interface</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700' rel='stylesheet' type='text/css'>
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            <h1 class="blue-main-title">OpenVeo Portal administration interface</h1>
        </div>
        <div class="yui3-u-1-4 version project-version">
            API Docs for: 4.0.3
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/opa.html">opa</a></li>
                                <li><a href="../classes/opaAbout.html">opaAbout</a></li>
                                <li><a href="../classes/OpaAboutController.html">OpaAboutController</a></li>
                                <li><a href="../classes/OpaAboutFactory.html">OpaAboutFactory</a></li>
                                <li><a href="../classes/opaActionsButton.html">opaActionsButton</a></li>
                                <li><a href="../classes/OpaActionsButtonController.html">OpaActionsButtonController</a></li>
                                <li><a href="../classes/opaDashboard.html">opaDashboard</a></li>
                                <li><a href="../classes/OpaDashboardController.html">OpaDashboardController</a></li>
                                <li><a href="../classes/OpaGroupsFactory.html">OpaGroupsFactory</a></li>
                                <li><a href="../classes/OpaI18nFactory.html">OpaI18nFactory</a></li>
                                <li><a href="../classes/OpaIndexController.html">OpaIndexController</a></li>
                                <li><a href="../classes/opaInfo.html">opaInfo</a></li>
                                <li><a href="../classes/OpaInfoButtonController.html">OpaInfoButtonController</a></li>
                                <li><a href="../classes/opaInfoConfiguration.html">opaInfoConfiguration</a></li>
                                <li><a href="../classes/OpaInfoController.html">OpaInfoController</a></li>
                                <li><a href="../classes/OpaInterceptor.html">OpaInterceptor</a></li>
                                <li><a href="../classes/opaLicenseKeyValidator.html">opaLicenseKeyValidator</a></li>
                                <li><a href="../classes/OpaLicenseKeyValidatorController.html">OpaLicenseKeyValidatorController</a></li>
                                <li><a href="../classes/opaLiveSettings.html">opaLiveSettings</a></li>
                                <li><a href="../classes/OpaLiveSettingsController.html">OpaLiveSettingsController</a></li>
                                <li><a href="../classes/OpaMediaContainerController.html">OpaMediaContainerController</a></li>
                                <li><a href="../classes/opaMediaLibrary.html">opaMediaLibrary</a></li>
                                <li><a href="../classes/OpaMediaLibraryController.html">OpaMediaLibraryController</a></li>
                                <li><a href="../classes/OpaMediaLibraryDialogController.html">OpaMediaLibraryDialogController</a></li>
                                <li><a href="../classes/opaMediaOption.html">opaMediaOption</a></li>
                                <li><a href="../classes/OpaMediaOptionController.html">OpaMediaOptionController</a></li>
                                <li><a href="../classes/opaMediaSelect.html">opaMediaSelect</a></li>
                                <li><a href="../classes/OpaMediaSelectController.html">OpaMediaSelectController</a></li>
                                <li><a href="../classes/opaNav.html">opaNav</a></li>
                                <li><a href="../classes/OpaNavController.html">OpaNavController</a></li>
                                <li><a href="../classes/opaNotificationConfiguration.html">opaNotificationConfiguration</a></li>
                                <li><a href="../classes/OpaNotificationController.html">OpaNotificationController</a></li>
                                <li><a href="../classes/OpaNotificationFactory.html">OpaNotificationFactory</a></li>
                                <li><a href="../classes/opaPromotedVideos.html">opaPromotedVideos</a></li>
                                <li><a href="../classes/OpaPromotedVideosController.html">OpaPromotedVideosController</a></li>
                                <li><a href="../classes/opaSettings.html">opaSettings</a></li>
                                <li><a href="../classes/OpaSettingsController.html">OpaSettingsController</a></li>
                                <li><a href="../classes/OpaSettingsFactory.html">OpaSettingsFactory</a></li>
                                <li><a href="../classes/opaStreamUrlValidator.html">opaStreamUrlValidator</a></li>
                                <li><a href="../classes/OpaStreamUrlValidatorController.html">OpaStreamUrlValidatorController</a></li>
                                <li><a href="../classes/opaTags.html">opaTags</a></li>
                                <li><a href="../classes/OpaTagsController.html">OpaTagsController</a></li>
                                <li><a href="../classes/opaToolbar.html">opaToolbar</a></li>
                                <li><a href="../classes/OpaToolbarController.html">OpaToolbarController</a></li>
                                <li><a href="../classes/OpaTranslateFilter.html">OpaTranslateFilter</a></li>
                                <li><a href="../classes/OpaUrlFactory.html">OpaUrlFactory</a></li>
                                <li><a href="../classes/OpaUserFactory.html">OpaUserFactory</a></li>
                                <li><a href="../classes/OpaVideosFactory.html">OpaVideosFactory</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/opa.html">opa</a></li>
                                <li><a href="../modules/opa.i18n.html">opa.i18n</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: /home/lhawsa/Documents/projects/openveo/openveo-portal/app/client/admin/index.controller.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
&#x27;use strict&#x27;;

/**
 * @module opa
 */

(function(app) {

  /**
   * Defines the main controller of the OpenVeo Portal administration interface.
   *
   * @class OpaIndexController
   * @constructor
   * @param {Object} $scope AngularJS scope
   * @param {Object} $route AngularJS $route service
   * @param {Object} $window AngularJS $window service
   * @param {Object} $location AngularJS $location service
   * @param {Object} $filter AngularJS $filter service
   * @param {Object} $mdMedia AngularJS Material service to evaluate media queries
   * @param {Object} $mdSidenav AngularJS Material service to manipulate sidenav directives
   * @param {Object} opaUserFactory User factory to deal with the authenticated user
   * @param {Object} opaI18nFactory I18n factory to manage languages
   * @param {Object} opaNotificationFactory Notification factory
   */
  function OpaIndexController(
    $scope,
    $route,
    $window,
    $location,
    $filter,
    $mdMedia,
    $mdSidenav,
    opaUserFactory,
    opaI18nFactory,
    opaNotificationFactory
  ) {
    var ctrl = this;
    var translateFilter = $filter(&#x27;opaTranslate&#x27;);

    Object.defineProperties(ctrl, {

      /**
       * Information about the page.
       *
       * @property page
       * @type Object
       * @final
       */
      page: {
        value: {}
      },

      /**
       * Title of the administration interface as a translation id.
       *
       * @property adminTitle
       * @type Object
       * @final
       */
      adminTitle: {
        value: &#x27;HEADER.TITLE&#x27;
      },

      /**
       * AngularJS Material $mdMedia service.
       *
       * @property $mdMedia
       * @type Object
       * @final
       */
      $mdMedia: {
        value: $mdMedia
      },

      /**
       * Menu links.
       *
       * @property menuLinks
       * @type Array
       * @final
       */
      menuLinks: {
        value: []
      },

      /**
       * The list of left actions for the toolbar.
       *
       * @property toolbarLeftActions
       * @type Array
       * @final
       */
      toolbarLeftActions: {
        value: []
      },

      /**
       * The list of right actions for the toolbar.
       *
       * @property toolbarRightActions
       * @type Array
       * @final
       */
      toolbarRightActions: {
        value: []
      },

      /**
       * The list of right actions for the advanced toolbar.
       *
       * @property advancedToolbarRightActions
       * @type Array
       * @final
       */
      advancedToolbarRightActions: {
        value: []
      },

      /**
       * Languages actions for the advanced toolbar.
       *
       * @property advancedToolbarLanguageActions
       * @type Array
       * @final
       */
      advancedToolbarLanguageActions: {
        value: []
      },

      /**
       * Toolbar page info.
       *
       * Holds the configuration of the toolbar info action button which presents an information about the actual
       * page. Information message changes with the router page.
       *
       * @property toolbarPageInfo
       * @type Object
       * @final
       */
      toolbarPageInfo: {
        value: {
          type: &#x27;info&#x27;,
          message: null,
          accessibility: translateFilter(&#x27;HEADER.INFO_ACCESSIBILITY&#x27;),
          help: translateFilter(&#x27;HEADER.INFO_TOOLTIP&#x27;)
        }
      },

      /**
       * Navigation menu for opa-nav component.
       *
       * @property navMenu
       * @type Array
       * @final
       */
      navMenu: {
        value: []
      },

      /**
       * Advanced navigation menu for opa-nav component.
       *
       * @property advancedNavMenu
       * @type Array
       * @final
       */
      advancedNavMenu: {
        value: []
      },

      /**
       * User&#x27;s language.
       *
       * @property userLanguage
       * @type String
       * @final
       */
      userLanguage: {
        value: opaUserFactory.getLanguage() || opaI18nFactory.getLanguages()[0]
      },

      /**
       * Indicates if ng-view is loaded or not.
       *
       * true if view is loaded, false if it is currently loading.
       *
       * @property isViewLoaded
       * @type Boolean
       */
      isViewLoaded: {
        value: false,
        writable: true
      },

      /**
       * Initializes properties for sub components.
       *
       * @method init
       * @final
       */
      init: {
        value: function() {
          var navLanguagesActions = [];
          var navDashboardAction = {
            label: translateFilter(&#x27;NAV.DASHBOARD&#x27;),
            icon: &#x27;dashboard&#x27;,
            action: ctrl.goTo,
            href: &#x27;/&#x27;
          };
          var navSettingsAction = {
            label: translateFilter(&#x27;NAV.SETTINGS&#x27;),
            icon: &#x27;settings&#x27;,
            action: ctrl.goTo,
            href: &#x27;/settings&#x27;
          };
          var navPromotedVideosAction = {
            label: translateFilter(&#x27;NAV.PROMOTED_VIDEOS&#x27;),
            icon: &#x27;view_quilt&#x27;,
            action: ctrl.goTo,
            href: &#x27;/promoted-videos&#x27;
          };

          opaI18nFactory.getLanguages().forEach(function(language) {
            ctrl.advancedToolbarLanguageActions.push({
              label: translateFilter(&#x27;HEADER.LANGUAGES.&#x27; + language),
              accessibility: translateFilter(&#x27;HEADER.LANGUAGES.&#x27; + language + &#x27;_ACCESSIBILITY&#x27;),
              code: language,
              action: ctrl.setLanguage,
              selected: language === ctrl.userLanguage
            });
            navLanguagesActions.push({
              label: translateFilter(&#x27;NAV.LANGUAGES.&#x27; + language),
              code: language,
              action: ctrl.setLanguage,
              selected: language === ctrl.userLanguage
            });
          });

          ctrl.toolbarLeftActions.push(
            {
              type: &#x27;icon&#x27;,
              accessibility: translateFilter(&#x27;HEADER.TOGGLE_MENU_ACCESSIBILITY&#x27;),
              help: translateFilter(&#x27;HEADER.TOGGLE_MENU_TOOLTIP&#x27;),
              icon: &#x27;menu&#x27;,
              action: ctrl.toggleSideNavigation
            }
          );

          ctrl.toolbarRightActions.push(ctrl.toolbarPageInfo);

          ctrl.advancedToolbarRightActions.push(
            {
              type: &#x27;icon&#x27;,
              accessibility: translateFilter(&#x27;HEADER.VIEW_PORTAL_ACCESSIBILITY&#x27;),
              help: translateFilter(&#x27;HEADER.VIEW_PORTAL_TOOLTIP&#x27;),
              icon: &#x27;visibility&#x27;,
              action: ctrl.goToPortal
            },
            {
              type: &#x27;list&#x27;,
              accessibility: translateFilter(&#x27;HEADER.TOGGLE_LANGUAGES_ACCESSIBILITY&#x27;),
              help: translateFilter(&#x27;HEADER.TOGGLE_LANGUAGES_TOOLTIP&#x27;),
              icon: &#x27;language&#x27;,
              menu: ctrl.advancedToolbarLanguageActions
            },
            {
              type: &#x27;list&#x27;,
              accessibility: translateFilter(&#x27;HEADER.TOGGLE_USER_ACTIONS_ACCESSIBILITY&#x27;),
              help: translateFilter(&#x27;HEADER.TOGGLE_USER_ACTIONS_TOOLTIP&#x27;),
              icon: &#x27;account_circle&#x27;,
              menu: [
                {
                  label: translateFilter(&#x27;HEADER.USER_ACTIONS.DISCONNECT&#x27;),
                  accessibility: translateFilter(&#x27;HEADER.USER_ACTIONS.DISCONNECT_ACCESSIBILITY&#x27;),
                  action: ctrl.logout
                }
              ]
            }
          );

          ctrl.navMenu.push(navDashboardAction, navPromotedVideosAction, navSettingsAction);

          ctrl.advancedNavMenu.push(
            navDashboardAction,
            navPromotedVideosAction,
            navSettingsAction,
            {
              divider: true
            },
            {
              label: translateFilter(&#x27;NAV.VIEW_PORTAL&#x27;),
              icon: &#x27;visibility&#x27;,
              action: ctrl.goToPortal
            },
            {
              label: translateFilter(&#x27;NAV.LANGUAGE&#x27;),
              icon: &#x27;language&#x27;,
              actions: navLanguagesActions
            },
            {
              divider: true
            },
            {
              label: translateFilter(&#x27;NAV.LOGOUT&#x27;),
              icon: &#x27;power_settings_new&#x27;,
              action: ctrl.logout
            }
          );
        }
      },

      /**
       * Logs out current user.
       *
       * @method logout
       * @final
       */
      logout: {
        value: function() {
          opaUserFactory.logout().then(function() {
            ctrl.goToPortal();
          });
        }
      },

      /**
       * Navigates to a back office page.
       *
       * @method goTo
       * @param {Object} item The menu item
       * @param {String} item.href The path to navigate to
       * @final
       */
      goTo: {
        value: function(item) {
          $location.path(item.href);
          ctrl.closeSideNavigation();
        }
      },

      /**
       * Navigates to the front office of the portal.
       *
       * @method goToPortal
       * @final
       */
      goToPortal: {
        value: function() {
          $window.location.href = &#x27;/&#x27;;
        }
      },

      /**
       * Sets user&#x27;s language.
       *
       * @method setLanguage
       * @param {Object} language A language description object
       * @param {String} language.code The language country code
       * @final
       */
      setLanguage: {
        value: function(language) {
          opaUserFactory.setLanguage(language.code);
          $window.location.href = &#x27;/be&#x27; + $location.path();
        }
      },

      /**
       * Closes side navigation.
       *
       * @method closeSideNavigation
       * @final
       */
      closeSideNavigation: {
        value: function() {
          $mdSidenav(&#x27;opa&#x27;).close();
        }
      },

      /**
       * Opens / closes side navigation.
       *
       * @method toggleSideNavigation
       * @final
       */
      toggleSideNavigation: {
        value: function() {
          $mdSidenav(&#x27;opa&#x27;).toggle();
        }
      },

      /**
       * Marks a menu item as selected.
       *
       * Both navigation menu and advanced navigation menu are updated.
       * The item with an &quot;href&quot; property corresponding to the given path will be selected,
       * selection on other items is removed.
       *
       * @method selectMenuItem
       * @final
       * @param {String} routePath The path of the item to select
       */
      selectMenuItem: {
        value: function(path) {
          var selectItem = function(navItem) {
            if (navItem.href === path)
              navItem.selected = true;
            else
              navItem.selected = false;
          };

          ctrl.navMenu.forEach(selectItem);
          ctrl.advancedNavMenu.forEach(selectItem);
        }
      }

    });

    // Listen to route change start event
    $scope.$on(&#x27;$routeChangeStart&#x27;, function(event, next) {
      ctrl.isViewLoaded = false;
      if (!opaUserFactory.isAuthenticated()) ctrl.goToPortal();
    });

    // Listen to route change success event
    $scope.$on(&#x27;$routeChangeSuccess&#x27;, function(event, route) {
      ctrl.page.title = route &amp;&amp; route.title;
      ctrl.page.pageTitle = route &amp;&amp; route.pageTitle;
      ctrl.toolbarPageInfo.message = (route &amp;&amp; route.pageInfo) ? translateFilter(route.pageInfo) : null;
      ctrl.selectMenuItem(route.originalPath);
    });

    // Listen to view loaded event emitted by ng-views
    $scope.$on(&#x27;opaViewLoaded&#x27;, function() {
      ctrl.isViewLoaded = true;
    });

    // Listen to event informing about an HTTP error
    // On a not authenticated error log out the user
    // On other errors just inform the user by displaying a notification
    $scope.$on(&#x27;opaHttpError&#x27;, function(event, data) {
      if (data &amp;&amp; data.authenticationError)
        ctrl.logout();
      else
        opaNotificationFactory.displayNotification(data.message, 0);
    });

    ctrl.init();
  }

  app.controller(&#x27;OpaIndexController&#x27;, OpaIndexController);
  OpaIndexController.$inject = [
    &#x27;$scope&#x27;,
    &#x27;$route&#x27;,
    &#x27;$window&#x27;,
    &#x27;$location&#x27;,
    &#x27;$filter&#x27;,
    &#x27;$mdMedia&#x27;,
    &#x27;$mdSidenav&#x27;,
    &#x27;opaUserFactory&#x27;,
    &#x27;opaI18nFactory&#x27;,
    &#x27;opaNotificationFactory&#x27;
  ];

})(angular.module(&#x27;opa&#x27;));

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
